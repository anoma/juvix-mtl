module Mtl.Trait.State;

import Stdlib.Prelude open;

trait
type State (S : Type) (M : Type -> Type) :=
  mkState@{
    {{monad}} : Monad M;
    get : M S;
    put : S -> M Unit;
  };

open State hiding {monad} public;

modify
  {S : Type}
  {M : Type → Type}
  {{Monad M}}
  {{State S M}}
  (f : S → S)
  : M Unit := get >>= λ{s := put (f s)};
