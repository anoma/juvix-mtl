module Mtl.MonadState;

import Stdlib.Prelude open;

trait
type MonadState (S : Type) (M : Type -> Type) :=
  mkMonadState@{
    {{monad}} : Monad M;
    get : M S;
    put : S -> M Unit;
  };

open MonadState hiding {monad} public;

modify
  {S : Type}
  {M : Type → Type}
  {{Monad M}}
  {{MonadState S M}}
  (f : S → S)
  : M Unit := get >>= λ{s := put (f s)};
